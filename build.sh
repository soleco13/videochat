#!/bin/bash

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
# –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–±–∏—Ä–∞–µ—Ç –±–∏–ª–¥ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑ –ª–∏—à–Ω–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

set -e

echo "üî® –ù–∞—á–∏–Ω–∞—é —Å–±–æ—Ä–∫—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞..."

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
cd "$(dirname "$0")/frontend"

# –°–æ–±–∏—Ä–∞–µ–º –±–∏–ª–¥ (Vite –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç –≤ ../staticfiles)
npm run build

# –û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Ä—Å–∏—é –¥–ª—è –æ–±—Ö–æ–¥–∞ –∫—ç—à–∞ –±—Ä–∞—É–∑–µ—Ä–∞
VERSION=$(date +%s)
echo "$VERSION" > ../.static_version

echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo "üì¶ –§–∞–π–ª—ã —Å–æ–±—Ä–∞–Ω—ã –≤: ../staticfiles"
echo "üî¢ –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: $VERSION"
echo ""
echo "üöÄ –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π –±–∏–ª–¥ –∏–∑ staticfiles/"
echo "   –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Django —Å–µ—Ä–≤–µ—Ä, –µ—Å–ª–∏ –æ–Ω –∑–∞–ø—É—â–µ–Ω, —á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è."

